<div class="add_post">
    <div method="post" action="/post" enctype="multipart/form-data">
        <div>
            <textarea id="content" required rows="10" cols="50" name="body"></textarea>
        </div>
        <!--
        <div class="resources">
            <div class="resource">
                <input name="resource" type="file" accept="image/*,video/*,audio/*"/>
            </div>
            <div class="resource">
                <input type="file" accept="image/*,video/*,audio/*"/>
            </div>
            <div class="resource">
                <input type="file" accept="image/*,video/*,audio/*"/>
            </div>
        </div>
        -->
        <div class="btns">
            <button class="submit" id="submit">Submit</button>
        </div>
    </div>
</div>

{{ define "scripts-add_post" }}
<script>
    var submitBtn = document.getElementById('submit');
    var contentInput = document.getElementById('content');
    var content;
    var onSubmit = function () {
        content = contentInput.value.trim();
        if (!content) {
            alert('must have content and cannot be blank');
            return;
        }
        submitBtn.disabled = true;
        ajax.post('/post', {
            content: content
        }, function (res){
            var o = JSON.parse(res);
            if (o.code === 0) {
                window.location.href = "/";
                return;
            }
            submitBtn.disabled = false;
            alert(o.error);
        });
    };
    submitBtn.onclick = onSubmit;
</script>
{{ end }}
